# filepath: src\virtualization\templates\dispenser_medicine.yaml
schemas:
  common_fields:
    _id: str
    type: str
    user_db_id: str # <-- Nuovo campo per l'ID utente del DB (sostituisce owner_id)
    # profile: # Rimuovi o commenta la sezione profile se owner_id era l'unico campo
    #   owner_id: str
    metadata:
      created_at: datetime
      updated_at: datetime
  entity:
    data:
      name: str
      interval: str
      regularity:
        type: list
        items:
          type: object
          properties:
            date: str
            times:
              type: list
              items: str
  validations:
    mandatory_fields:
      root:
        - _id
        - type
        - user_db_id # <-- Rendi obbligatorio il nuovo campo
      metadata:
        - created_at
        - updated_at
    type_constraints:
      user_db_id: # <-- Aggiungi vincolo tipo
         type: str
      name:
        type: str
        min_length: 1
        max_length: 100
      interval:
        type: str
        pattern: "^[0-2]?[0-9]-[0-2]?[0-9]$"
      regularity:
        type: list
    initialization:
      name: "dispenser"
      interval: ""
      regularity: []
      # Non inizializzare user_db_id, deve essere fornito alla creazione